pipeline {
    agent any
    
   
     
    stages {
      stage('checkout') {
           steps {
             
                git branch: 'master', url: 'https://github.com/akhiljosef/CI-usingAnsible.git'
             
          }
        }
       stage('Ansible Init') {
            steps {
              sh 'ansible --version'
            }
       }
       stage('Execute Maven') {
           steps {
             
                sh 'mvn package'             
          }
        }
        stage('Host reacable') {
             
            steps {
                 
             
               
              sh "ansible all -i inventories/dev/hosts -m ping -u root " 
               
            
            }
        }
        stage('Ansible Deploy') {
             
            steps {
                 
             
               
               sh "ansible-playbook ansible.yml -i inventories/dev/hosts --user root --key-file .ssh/id_rsa" 
               
            
            }
        }

    }
}